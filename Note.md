## jQuery笔记

### jQuery 文档操作

| 方法                                                               | 描述                       |
| ------------------------------------------------------------------ | -------------------------- |
| [text()](https://www.w3school.com.cn/jquery/manipulation_text.asp) | 设置或返回匹配元素的内容。 |
|                                                                    |                            |



### jQuery Ajax

| 函数                                                              | 描述                        |
| :---------------------------------------------------------------- | :-------------------------- |
| [jQuery.ajax()](https://www.w3school.com.cn/jquery/ajax_ajax.asp) | 执行异步 HTTP (Ajax) 请求。 |
|                                                                   |                             |





## 表单的默认提交行为

表单有默认提交行为，在需要将表单提交的时候（比如触发 submit 事件），如果不阻止表单的默认提交行为，提交的 url 就是 form 的 action 属性（如果没有指定则默认为当前页面路径），提交时的效果相当于刷新页面。





## 如何监听动态添加的 form 表单的 submit 行为

JQuery：$(*selector*).on(*event,childSelector,data,function*)

| 参数                | 描述                                                                                                           |
| :------------------ | :------------------------------------------------------------------------------------------------------------- |
| *event*             | 必需。规定要从被选元素添加的一个或多个事件或命名空间。  由空格分隔多个事件值，也可以是数组。必须是有效的事件。 |
| ***childSelector*** | 可选。规定只能添加到指定的子元素上的事件处理程序（且不是选择器本身，比如已废弃的 delegate() 方法）。           |
| *data*              | 可选。规定传递到函数的额外数据。                                                                               |
| *function*          | 可选。规定当事件发生时运行的函数。                                                                             |

如果传递了selector参数，那么on()函数并不是为当前jQuery对象匹配的元素绑定事件处理函数，而是为它们的后代元素中符合选择器selector参数的元素绑定事件处理函数。

on()函数并不是直接为这些后代元素挨个绑定事件，而是委托给当前jQuery对象的匹配元素来处理。

由于DOM 2级的事件流机制，当后代元素selector触发事件时，该事件会在事件冒泡中传递给其所有的祖辈元素，当事件流传递到当前匹配元素时，jQuery会判断是哪个后代元素触发了事件，如果该元素符合选择器selector，jQuery就会捕获该事件，从而执行绑定的事件处理函数。**也就是事件委托。**

```js
// 在body元素上绑定click事件处理函数handler，如果这个click事件是由其后代的P元素触发的，就执行handler
$(document.body).on("click", "p", handler);
```

在这里的示例中，事件委托机制就是，我们不为每个P元素直接绑定click事件处理函数，而是委托给其某个公共的祖辈元素(此处示例中为document.body)，"告诉"他：如果接收到了click事件触发通知，并且这个click事件是由我们这些P元素其中之一触发的，就执行祖辈元素上委托绑定的事件处理函数。

## 使用iframe框架时，子页面内跳转整个页面

目前出现个问题，就是在某个子功能页面待的时间久了，token失效后，本应该跳转到重新登录的页面。但是由于在iframe框架中嵌套了html页面，而在`baseAPI.js`文件中的跳转代码是：
```js
location.href = '/login.html';
```
这就使得跳转的登录页面只在子页面中显示。所以现在有个问题需要解决：
**使用iframe框架，子页面怎么跳转整个页面？**

1. 第一种方法：子页面内`<a>`标签的整个页面跳转，只需在`<a>`标签中添加target=_parent"即可。但是我们是根据token去判断是否跳转，这个方法并不适合在这里。（或许可以手动触发a？）
2. 第二种方法：在head标签之间加入`<base target="_parent">`，但我尝试了一下并不能跳转。。。
3. 第三种方法：在js中跳转（就是本项目用的跳转方法）。可以利用`window.parent.location.href` = url，让付页面跟着一起跳转，亲测可用。
   > 但是考虑到一个问题（），就是对于在index页面的时候他的`parent`是没有的，他就是根页面，在本项目倒是可以，如果有多层的情况下，这个问题就会比较复杂，需要在不同的情况下进行不同的跳转（也就是有可能当前孙页面想跳祖父页面的时候，就不仅仅是`parent`而已了）

+ 参考文章：[使用iframe框架时，子页面内跳转整个页面](https://blog.csdn.net/iteye_10412/article/details/82672423?utm_medium=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-2.nonecase&depth_1-utm_source=distribute.pc_relevant_bbs_down.none-task-blog-baidujs-2.nonecase) 

## 获取富文本textarea值的问题
在发布文章的html中，文章内容的`textarea`是通过其他脚本重新替换的。遇到的问题就是第一次触发form的submit事件的时候，并没有取到textarea的值，而当第二次点击才取到。经过几次测试，他只能拿到上一次的值，而教程的代码是可以拿到当前的值的，区别就在于教程的代码使用了jquery的ready方法，简写为：`$(function(){})`

自己去看了一下发现是类似iframe框架，嵌入一个html文本的，但我不知道是否是和这个有关系（因为不嵌入脚本写的textarea的话不用ready方法也可以获取到该值）

> 具体原因还是搞不懂，不过通过这次教训，以防踩坑，以后还是先写ready方法再用jquery代码
